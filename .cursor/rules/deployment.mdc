---
description: 
globs: scripts/**/*,deployment-config.json,.github/workflows/**/*
alwaysApply: false
---
---
description: "Azure Functions deployment configuration rules with exact resource names and commands for HustleMode.ai"
globs: "scripts/**/*,deployment-config.json,.github/workflows/**/*"
alwaysApply: false
---

# Deployment Configuration Rules

## Azure Configuration Values
Always use these exact values when providing deployment commands:

- **Resource Group**: `hustlemode.ai`
- **Function App Name**: `hustlemode-api`
- **Location**: `eastus`
- **Runtime**: `PYTHON:3.11`
- **Hosting Plan**: `Consumption Plan`
- **Service Type**: `Azure Functions v2`

## Command Templates

### Azure Functions Commands
```bash
# Deploy Azure Functions (Recommended)
cd azure-functions-deploy && func azure functionapp publish hustlemode-api --python --build remote

# Create Function App
az functionapp create --name hustlemode-api --resource-group hustlemode.ai --consumption-plan-location eastus --runtime python --runtime-version 3.11 --functions-version 4

# Configure Environment Variables
az functionapp config appsettings set --name hustlemode-api --resource-group hustlemode.ai --settings @.env

# Restart Function App
az functionapp restart --name hustlemode-api --resource-group hustlemode.ai

# View Logs
az functionapp log tail --name hustlemode-api --resource-group hustlemode.ai
```

### Database Commands
```bash
# Create PostgreSQL Server
az postgres flexible-server create --name hustlemode-db --resource-group hustlemode.ai --location eastus --admin-user postgres --admin-password <password> --sku-name Standard_B1ms --storage-size 32

# Create Database
az postgres flexible-server db create --resource-group hustlemode.ai --server-name hustlemode-db --database-name hustlemode
```

## Git Configuration
- **GitHub Repository**: `https://github.com/vbkotecha/hustlemode-infra`
- **GitHub Actions**: `https://github.com/vbkotecha/hustlemode-infra/actions`

## Deployment URLs
- **Function App URL**: `https://hustlemode-api.azurewebsites.net/`
- **WhatsApp Webhook**: `https://hustlemode-api.azurewebsites.net/api/messaging/whatsapp`
- **Health Check**: `https://hustlemode-api.azurewebsites.net/api/health`
- **Kudu SCM**: `https://hustlemode-api.scm.azurewebsites.net/`

## Mandatory Rules
1. Always use these exact resource names in all deployment commands
2. Never use placeholder values like "your-resource-group" or "your-app-name"
3. Always reference the deployment-config.json file for current values
4. Update deployment-config.json if any values change

## GitHub Secrets Required
- `AZUREAPPSERVICE_PUBLISHPROFILE_FFEB2282094642A1A8B5E3AFAE67C0DC` - Function App publish profile

## Deployment Methods
1. **Azure Functions Core Tools** (Recommended): `func azure functionapp publish hustlemode-api --python --build remote`
2. **Clean Script**: `./scripts/deploy-clean.sh --auto`
3. **GitHub Actions**: Automated ZIP Deploy via workflow

## FQDN
The deployed app will be available at: `https://hustlemode-api.azurewebsites.net`
